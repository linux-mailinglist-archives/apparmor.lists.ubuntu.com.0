Return-Path: <apparmor-bounces@lists.ubuntu.com>
X-Original-To: lists+apparmor@lfdr.de
Delivered-To: lists+apparmor@lfdr.de
Received: from huckleberry.canonical.com (huckleberry.canonical.com [91.189.94.19])
	by mail.lfdr.de (Postfix) with ESMTPS id 9AB25470A3B
	for <lists+apparmor@lfdr.de>; Fri, 10 Dec 2021 20:19:38 +0100 (CET)
Received: from localhost ([127.0.0.1] helo=huckleberry.canonical.com)
	by huckleberry.canonical.com with esmtp (Exim 4.86_2)
	(envelope-from <apparmor-bounces@lists.ubuntu.com>)
	id 1mvlQV-0002vo-UJ; Fri, 10 Dec 2021 19:19:27 +0000
Received: from smtp-relay-internal-1.internal ([10.131.114.114]
 helo=smtp-relay-internal-1.canonical.com)
 by huckleberry.canonical.com with esmtps
 (TLS1.2:ECDHE_RSA_AES_128_GCM_SHA256:128) (Exim 4.86_2)
 (envelope-from <georgia.garcia@canonical.com>) id 1mvlQT-0002vh-0P
 for apparmor@lists.ubuntu.com; Fri, 10 Dec 2021 19:19:25 +0000
Received: from mail-qt1-f197.google.com (mail-qt1-f197.google.com
 [209.85.160.197])
 (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)
 key-exchange X25519 server-signature RSA-PSS (2048 bits) server-digest SHA256)
 (No client certificate requested)
 by smtp-relay-internal-1.canonical.com (Postfix) with ESMTPS id C31BA3F1BA
 for <apparmor@lists.ubuntu.com>; Fri, 10 Dec 2021 19:19:23 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=canonical.com;
 s=20210705; t=1639163963;
 bh=VGXShRs9Pk9nLX+2L2/DXeKy4hp8hf8t3txqqW6ZeyU=;
 h=From:To:Cc:Subject:Date:Message-Id:MIME-Version;
 b=HE2sgxzdpYBbTM9Tp3F4ML73zlJMQDsy0lSbCrtrvW+FE9D1fb4RumVfeNBDppAUI
 vPMe+GRfdsCZriT7U5vopHnEoeiTFZIDB55krZAoZqiwtbpnqBMx3AMHU+LweRoxhc
 LHU+TgrkwCGwMh0LvmmGdQfPMAc0vWemzSOnxnjS9RHlFmbgKD4r+3ieCFnb4XK1Uw
 Kvhssrx2dJnqJ8pFSlQ5hN7UBSFsLAz+n17wlEObljTbXalMJL7C39QqFDYpPifrOb
 pQakTH+QoEvSjbWrnXWCs6bbbGtbcIT1HY/EECeN7lyqoAu8TLh1Sw78dfaHZHH9cI
 pcb97rk+sQ+NA==
Received: by mail-qt1-f197.google.com with SMTP id
 e14-20020a05622a110e00b002b0681d127eso15103959qty.15
 for <apparmor@lists.ubuntu.com>; Fri, 10 Dec 2021 11:19:23 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20210112;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=VGXShRs9Pk9nLX+2L2/DXeKy4hp8hf8t3txqqW6ZeyU=;
 b=tzCb5RDxeSXT1Nh7syYMOE/VCx0wmqBGwTcD36b+/ZXiKhVuZxWGknjE0vtfBsSRCA
 tD7hFtv+YpYzRsloTCZAMjugS6o/6Mi89LGGq204r1biZ+eiMZgqaELgoDBCCcyKp+AW
 sSRHYlEwM0IPwX0v6QClomfdjvp6c0ueW2Juj7/8SC9HPst9lsTMUTBLhdr6rxbcMfPz
 nzBVJgvNomDIpl+0ulFeSl4zN+zirmArnLfia+qBbEjESPHy9lZ9qXhQETlVFA62VqHf
 NWuIKhfQ0RiZIwAOlQzmcwGf4ZavTmQkesUQfxJKc05PbFUw6dB582uFvHMn2lcphwO3
 5kig==
X-Gm-Message-State: AOAM5303IFHpqNChzx+4reXZbcC643PBnzcIKYZPyX8JMTbq0hsg0zw/
 qMZxeZQwP8xfiCyaRqoto4F+w3BW0nN8H+dBThFpPaZvKA32aeGwa1HMQMGo5PfipbEsECb+2fp
 lQICyE7eUzfyJWKA+LDvLaaU1i9nC1PPRso0dKg==
X-Received: by 2002:a05:622a:5cf:: with SMTP id
 d15mr29447111qtb.388.1639163962496; 
 Fri, 10 Dec 2021 11:19:22 -0800 (PST)
X-Google-Smtp-Source: ABdhPJzJl/tWuCBAZWG3go/1fPboqwszuJYSgv0bs/EUT8jLLmT7e/+sBzXenwiWPm1m+jiPa/0kMw==
X-Received: by 2002:a05:622a:5cf:: with SMTP id
 d15mr29447054qtb.388.1639163962047; 
 Fri, 10 Dec 2021 11:19:22 -0800 (PST)
Received: from localhost ([2804:431:c7ef:ece7:62b8:3ae0:c11c:f4a9])
 by smtp.gmail.com with ESMTPSA id j124sm1700153qkd.98.2021.12.10.11.19.20
 (version=TLS1_3 cipher=TLS_AES_128_GCM_SHA256 bits=128/128);
 Fri, 10 Dec 2021 11:19:21 -0800 (PST)
From: Georgia Garcia <georgia.garcia@canonical.com>
To: apparmor@lists.ubuntu.com
Date: Fri, 10 Dec 2021 16:19:19 -0300
Message-Id: <20211210191919.152183-1-georgia.garcia@canonical.com>
X-Mailer: git-send-email 2.25.1
MIME-Version: 1.0
Subject: [apparmor] [PATCH v3] apparmor: add module mediation
X-BeenThere: apparmor@lists.ubuntu.com
X-Mailman-Version: 2.1.20
Precedence: list
List-Id: AppArmor discussion <apparmor.lists.ubuntu.com>
List-Unsubscribe: <https://lists.ubuntu.com/mailman/options/apparmor>,
 <mailto:apparmor-request@lists.ubuntu.com?subject=unsubscribe>
List-Archive: <https://lists.ubuntu.com/archives/apparmor>
List-Post: <mailto:apparmor@lists.ubuntu.com>
List-Help: <mailto:apparmor-request@lists.ubuntu.com?subject=help>
List-Subscribe: <https://lists.ubuntu.com/mailman/listinfo/apparmor>,
 <mailto:apparmor-request@lists.ubuntu.com?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: apparmor-bounces@lists.ubuntu.com
Sender: "AppArmor" <apparmor-bounces@lists.ubuntu.com>

UHJvdmlkZSBiYXNpYyBtZWRpYXRpb24gZm9yIG1vZHVsZSBsb2FkaW5nLgoKVGhlIHVzZXIgc3Bh
Y2UgcnVsZSBoYXMgdGhlIGZvbGxvd2luZyBmb3JtOgogICAgTU9EVUxFIFJVTEUgPSBbIFFVQUxJ
RklFUlMgXSAnbW9kdWxlJyBbIE1PREUgXQogICAgCSAgIAkgIFsgUEFUSCB8IE1PRFVMRSBOQU1F
IF0KCiAgICBNT0RFID0gKCAnbG9hZF9kYXRhJyB8ICdsb2FkX2ZpbGUnIHwgJ3JlcXVlc3QnICkK
CiAgICBQQVRIID0gcGF0aCB0byBsb2FkYWJsZSBrZXJuZWwgbW9kdWxlCgogICAgTU9EVUxFIE5B
TUUgPSBuYW1lIG9mIHRoZSBtb2R1bGUgdG8gYmUgcmVxdWVzdGVkIHRvIG1vZHByb2JlCgpTaWdu
ZWQtb2ZmLWJ5OiBHZW9yZ2lhIEdhcmNpYSA8Z2VvcmdpYS5nYXJjaWFAY2Fub25pY2FsLmNvbT4K
LS0tCgp2MjogUmVwbGFjZWQgJTAgYnkgMCBpbiBjb21tZW50cywgYW5kIGZpeGVkIHR5cG8gaW4g
dGhlIGNvbW1pdCBtZXNzYWdlLgoKdjM6IEkgbm90aWNlZCB3aGlsZSBydW5uaW5nIHRoZSByZWdy
ZXNzaW9uIHRlc3RzIHRoYXQga21vZF9uYW1lIHdhcwpub3Qgc2V0IG9uIGF1ZGl0LgpUaGUgcGFy
c2VyIGFuZCB0aGUgcmVncmVzc2lvbiB0ZXN0cyBhcmUgYXZhaWxhYmxlIGF0OgpodHRwczovL2dp
dGxhYi5jb20vYXBwYXJtb3IvYXBwYXJtb3IvLS9tZXJnZV9yZXF1ZXN0cy84MTYKCi0tLQogc2Vj
dXJpdHkvYXBwYXJtb3IvTWFrZWZpbGUgICAgICAgICAgIHwgICAzICstCiBzZWN1cml0eS9hcHBh
cm1vci9hcHBhcm1vcmZzLmMgICAgICAgfCAgIDcgKwogc2VjdXJpdHkvYXBwYXJtb3IvaW5jbHVk
ZS9hcHBhcm1vci5oIHwgICAzICstCiBzZWN1cml0eS9hcHBhcm1vci9pbmNsdWRlL2F1ZGl0Lmgg
ICAgfCAgIDEgKwogc2VjdXJpdHkvYXBwYXJtb3IvaW5jbHVkZS9tb2R1bGUuaCAgIHwgIDI0ICsr
Kwogc2VjdXJpdHkvYXBwYXJtb3IvbHNtLmMgICAgICAgICAgICAgIHwgIDU2ICsrKysrKwogc2Vj
dXJpdHkvYXBwYXJtb3IvbW9kdWxlLmMgICAgICAgICAgIHwgMjc1ICsrKysrKysrKysrKysrKysr
KysrKysrKysrKwogNyBmaWxlcyBjaGFuZ2VkLCAzNjcgaW5zZXJ0aW9ucygrKSwgMiBkZWxldGlv
bnMoLSkKIGNyZWF0ZSBtb2RlIDEwMDY0NCBzZWN1cml0eS9hcHBhcm1vci9pbmNsdWRlL21vZHVs
ZS5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgc2VjdXJpdHkvYXBwYXJtb3IvbW9kdWxlLmMKCmRpZmYg
LS1naXQgYS9zZWN1cml0eS9hcHBhcm1vci9NYWtlZmlsZSBiL3NlY3VyaXR5L2FwcGFybW9yL01h
a2VmaWxlCmluZGV4IGZmMjNmY2ZlZmUxOS4uOTMyZDYyMWJhNGI1IDEwMDY0NAotLS0gYS9zZWN1
cml0eS9hcHBhcm1vci9NYWtlZmlsZQorKysgYi9zZWN1cml0eS9hcHBhcm1vci9NYWtlZmlsZQpA
QCAtNSw3ICs1LDggQEAgb2JqLSQoQ09ORklHX1NFQ1VSSVRZX0FQUEFSTU9SKSArPSBhcHBhcm1v
ci5vCiAKIGFwcGFybW9yLXkgOj0gYXBwYXJtb3Jmcy5vIGF1ZGl0Lm8gY2FwYWJpbGl0eS5vIHRh
c2subyBpcGMubyBsaWIubyBtYXRjaC5vIFwKICAgICAgICAgICAgICAgcGF0aC5vIGRvbWFpbi5v
IHBvbGljeS5vIHBvbGljeV91bnBhY2subyBwcm9jYXR0ci5vIGxzbS5vIFwKLSAgICAgICAgICAg
ICAgcmVzb3VyY2UubyBzZWNpZC5vIGZpbGUubyBwb2xpY3lfbnMubyBsYWJlbC5vIG1vdW50Lm8g
bmV0Lm8KKyAgICAgICAgICAgICAgcmVzb3VyY2UubyBzZWNpZC5vIGZpbGUubyBwb2xpY3lfbnMu
byBsYWJlbC5vIG1vdW50Lm8gbmV0Lm8gXAorICAgICAgICAgICAgICBtb2R1bGUubwogYXBwYXJt
b3ItJChDT05GSUdfU0VDVVJJVFlfQVBQQVJNT1JfSEFTSCkgKz0gY3J5cHRvLm8KIAogY2xlYW4t
ZmlsZXMgOj0gY2FwYWJpbGl0eV9uYW1lcy5oIHJsaW1fbmFtZXMuaCBuZXRfbmFtZXMuaApkaWZm
IC0tZ2l0IGEvc2VjdXJpdHkvYXBwYXJtb3IvYXBwYXJtb3Jmcy5jIGIvc2VjdXJpdHkvYXBwYXJt
b3IvYXBwYXJtb3Jmcy5jCmluZGV4IDJlZTNiM2QyOWYxMC4uZjM1OTc4YWQ1YzM0IDEwMDY0NAot
LS0gYS9zZWN1cml0eS9hcHBhcm1vci9hcHBhcm1vcmZzLmMKKysrIGIvc2VjdXJpdHkvYXBwYXJt
b3IvYXBwYXJtb3Jmcy5jCkBAIC0yMzU3LDYgKzIzNTcsMTIgQEAgc3RhdGljIHN0cnVjdCBhYV9z
ZnNfZW50cnkgYWFfc2ZzX2VudHJ5X3F1ZXJ5W10gPSB7CiAJQUFfU0ZTX0RJUigibGFiZWwiLAkJ
CWFhX3Nmc19lbnRyeV9xdWVyeV9sYWJlbCksCiAJeyB9CiB9OworCitzdGF0aWMgc3RydWN0IGFh
X3Nmc19lbnRyeSBhYV9zZnNfZW50cnlfbW9kdWxlW10gPSB7CisJQUFfU0ZTX0ZJTEVfU1RSSU5H
KCJtYXNrIiwgImxvYWRfZGF0YSBsb2FkX2ZpbGUgcmVxdWVzdCIpLAorCXsgfQorfTsKKwogc3Rh
dGljIHN0cnVjdCBhYV9zZnNfZW50cnkgYWFfc2ZzX2VudHJ5X2ZlYXR1cmVzW10gPSB7CiAJQUFf
U0ZTX0RJUigicG9saWN5IiwJCQlhYV9zZnNfZW50cnlfcG9saWN5KSwKIAlBQV9TRlNfRElSKCJk
b21haW4iLAkJCWFhX3Nmc19lbnRyeV9kb21haW4pLApAQCAtMjM3MCw2ICsyMzc2LDcgQEAgc3Rh
dGljIHN0cnVjdCBhYV9zZnNfZW50cnkgYWFfc2ZzX2VudHJ5X2ZlYXR1cmVzW10gPSB7CiAJQUFf
U0ZTX0RJUigicHRyYWNlIiwJCQlhYV9zZnNfZW50cnlfcHRyYWNlKSwKIAlBQV9TRlNfRElSKCJz
aWduYWwiLAkJCWFhX3Nmc19lbnRyeV9zaWduYWwpLAogCUFBX1NGU19ESVIoInF1ZXJ5IiwJCQlh
YV9zZnNfZW50cnlfcXVlcnkpLAorCUFBX1NGU19ESVIoIm1vZHVsZSIsCQkJYWFfc2ZzX2VudHJ5
X21vZHVsZSksCiAJeyB9CiB9OwogCmRpZmYgLS1naXQgYS9zZWN1cml0eS9hcHBhcm1vci9pbmNs
dWRlL2FwcGFybW9yLmggYi9zZWN1cml0eS9hcHBhcm1vci9pbmNsdWRlL2FwcGFybW9yLmgKaW5k
ZXggMWZiYWJkYjU2NWE4Li5jZjhiMzE1ZGZmZGMgMTAwNjQ0Ci0tLSBhL3NlY3VyaXR5L2FwcGFy
bW9yL2luY2x1ZGUvYXBwYXJtb3IuaAorKysgYi9zZWN1cml0eS9hcHBhcm1vci9pbmNsdWRlL2Fw
cGFybW9yLmgKQEAgLTI4LDggKzI4LDkgQEAKICNkZWZpbmUgQUFfQ0xBU1NfU0lHTkFMCQkxMAog
I2RlZmluZSBBQV9DTEFTU19ORVQJCTE0CiAjZGVmaW5lIEFBX0NMQVNTX0xBQkVMCQkxNgorI2Rl
ZmluZSBBQV9DTEFTU19NT0RVTEUgICAgICAgICAxNwogCi0jZGVmaW5lIEFBX0NMQVNTX0xBU1QJ
CUFBX0NMQVNTX0xBQkVMCisjZGVmaW5lIEFBX0NMQVNTX0xBU1QJCUFBX0NMQVNTX01PRFVMRQog
CiAvKiBDb250cm9sIHBhcmFtZXRlcnMgc2V0dGFibGUgdGhyb3VnaCBtb2R1bGUvYm9vdCBmbGFn
cyAqLwogZXh0ZXJuIGVudW0gYXVkaXRfbW9kZSBhYV9nX2F1ZGl0OwpkaWZmIC0tZ2l0IGEvc2Vj
dXJpdHkvYXBwYXJtb3IvaW5jbHVkZS9hdWRpdC5oIGIvc2VjdXJpdHkvYXBwYXJtb3IvaW5jbHVk
ZS9hdWRpdC5oCmluZGV4IDE4NTE5YTRlYjY3ZS4uMjIyZmRjMTg1NzliIDEwMDY0NAotLS0gYS9z
ZWN1cml0eS9hcHBhcm1vci9pbmNsdWRlL2F1ZGl0LmgKKysrIGIvc2VjdXJpdHkvYXBwYXJtb3Iv
aW5jbHVkZS9hdWRpdC5oCkBAIC0xMDMsNiArMTAzLDcgQEAgZW51bSBhdWRpdF90eXBlIHsKICNk
ZWZpbmUgT1BfUFJPRl9MT0FEICJwcm9maWxlX2xvYWQiCiAjZGVmaW5lIE9QX1BST0ZfUk0gInBy
b2ZpbGVfcmVtb3ZlIgogCisjZGVmaW5lIE9QX01PRFVMRSAibW9kdWxlIgogCiBzdHJ1Y3QgYXBw
YXJtb3JfYXVkaXRfZGF0YSB7CiAJaW50IGVycm9yOwpkaWZmIC0tZ2l0IGEvc2VjdXJpdHkvYXBw
YXJtb3IvaW5jbHVkZS9tb2R1bGUuaCBiL3NlY3VyaXR5L2FwcGFybW9yL2luY2x1ZGUvbW9kdWxl
LmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi41NzM3OGQ4YjVjYTIK
LS0tIC9kZXYvbnVsbAorKysgYi9zZWN1cml0eS9hcHBhcm1vci9pbmNsdWRlL21vZHVsZS5oCkBA
IC0wLDAgKzEsMjQgQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkg
Ki8KKy8qCisgKiBBcHBBcm1vciBzZWN1cml0eSBtb2R1bGUKKyAqCisgKiBUaGlzIGZpbGUgY29u
dGFpbnMgQXBwQXJtb3IgbW9kdWxlIG1lZGlhdGlvbiBmdW5jdGlvbiBkZWZpbml0aW9ucy4KKyAq
CisgKiBDb3B5cmlnaHQgMjAyMSBDYW5vbmljYWwgTHRkLgorICovCisKKyNpZm5kZWYgX19BQV9N
T0RVTEVfSAorI2RlZmluZSBfX0FBX01PRFVMRV9ICisKKyNkZWZpbmUgQUFfTUFZX0xPQURfREFU
QQlBQV9NQVlfV1JJVEUKKyNkZWZpbmUgQUFfTUFZX0xPQURfRklMRQlBQV9NQVlfQ1JFQVRFCisj
ZGVmaW5lIEFBX01BWV9SRVFVRVNUCQlBQV9NQVlfQVBQRU5ECisjZGVmaW5lIEFBX1ZBTElEX01P
RFVMRV9QRVJNUyAoQUFfTUFZX0xPQURfREFUQSB8IEFBX01BWV9MT0FEX0ZJTEUgfCBcCisJCQkg
ICAgICAgQUFfTUFZX1JFUVVFU1QpCisKK2ludCBhYV9tb2R1bGVfZnJvbV9maWxlKHN0cnVjdCBh
YV9sYWJlbCAqbGFiZWwsIHN0cnVjdCBmaWxlICpmaWxlLAorCQkJdTMyIHJlcXVlc3QpOworaW50
IGFhX21vZHVsZV9mcm9tX25hbWUoc3RydWN0IGFhX2xhYmVsICpsYWJlbCwgY2hhciAqbmFtZSwK
KwkJCXUzMiByZXF1ZXN0LCBpbnQgZGF0YV90eXBlKTsKKworI2VuZGlmIC8qIF9fQUFfTU9EVUxF
X0ggKi8KZGlmZiAtLWdpdCBhL3NlY3VyaXR5L2FwcGFybW9yL2xzbS5jIGIvc2VjdXJpdHkvYXBw
YXJtb3IvbHNtLmMKaW5kZXggZjcyNDA2ZmUxYmYyLi4wNmQ2M2M4ZDdkZTcgMTAwNjQ0Ci0tLSBh
L3NlY3VyaXR5L2FwcGFybW9yL2xzbS5jCisrKyBiL3NlY3VyaXR5L2FwcGFybW9yL2xzbS5jCkBA
IC0zOCw2ICszOCw3IEBACiAjaW5jbHVkZSAiaW5jbHVkZS9wb2xpY3kuaCIKICNpbmNsdWRlICJp
bmNsdWRlL3BvbGljeV9ucy5oIgogI2luY2x1ZGUgImluY2x1ZGUvcHJvY2F0dHIuaCIKKyNpbmNs
dWRlICJpbmNsdWRlL21vZHVsZS5oIgogI2luY2x1ZGUgImluY2x1ZGUvbW91bnQuaCIKICNpbmNs
dWRlICJpbmNsdWRlL3NlY2lkLmgiCiAKQEAgLTExNjksNiArMTE3MCw1NyBAQCBzdGF0aWMgaW50
IGFwcGFybW9yX2luZXRfY29ubl9yZXF1ZXN0KGNvbnN0IHN0cnVjdCBzb2NrICpzaywgc3RydWN0
IHNrX2J1ZmYgKnNrYgogfQogI2VuZGlmCiAKK3N0YXRpYyBpbnQgYXBwYXJtb3Jfa2VybmVsX21v
ZHVsZV9yZXF1ZXN0KGNoYXIgKmttb2RfbmFtZSkKK3sKKwlzdHJ1Y3QgYWFfbGFiZWwgKmxhYmVs
OworCWludCBlcnJvciA9IDA7CisKKwlsYWJlbCA9IF9fYmVnaW5fY3VycmVudF9sYWJlbF9jcml0
X3NlY3Rpb24oKTsKKwllcnJvciA9IGFhX21vZHVsZV9mcm9tX25hbWUobGFiZWwsIGttb2RfbmFt
ZSwgQUFfTUFZX1JFUVVFU1QsIExTTV9BVURJVF9EQVRBX0tNT0QpOworCV9fZW5kX2N1cnJlbnRf
bGFiZWxfY3JpdF9zZWN0aW9uKGxhYmVsKTsKKworCXJldHVybiBlcnJvcjsKK30KKworc3RhdGlj
IGludCBhcHBhcm1vcl9rZXJuZWxfbG9hZF9kYXRhKGVudW0ga2VybmVsX2xvYWRfZGF0YV9pZCBp
ZCwKKwkJCQkgICAgIGJvb2wgY29udGVudHMpCit7CisJc3RydWN0IGFhX2xhYmVsICpsYWJlbDsK
KwlpbnQgZXJyb3IgPSAwOworCisJc3dpdGNoIChpZCkgeworCWNhc2UgTE9BRElOR19NT0RVTEU6
CisJCWxhYmVsID0gX19iZWdpbl9jdXJyZW50X2xhYmVsX2NyaXRfc2VjdGlvbigpOworCQllcnJv
ciA9IGFhX21vZHVsZV9mcm9tX25hbWUobGFiZWwsICIiLCBBQV9NQVlfTE9BRF9EQVRBLCBMU01f
QVVESVRfREFUQV9OT05FKTsKKwkJX19lbmRfY3VycmVudF9sYWJlbF9jcml0X3NlY3Rpb24obGFi
ZWwpOworCQlicmVhazsKKwlkZWZhdWx0OgorCQlicmVhazsKKwl9CisKKwlyZXR1cm4gZXJyb3I7
Cit9CisKK3N0YXRpYyBpbnQgYXBwYXJtb3Jfa2VybmVsX3JlYWRfZmlsZShzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJCQkgICAgIGVudW0ga2VybmVsX3JlYWRfZmlsZV9pZCBpZCwKKwkJCQkgICAgIGJv
b2wgY29udGVudHMpCit7CisJc3RydWN0IGFhX2xhYmVsICpsYWJlbDsKKwlpbnQgZXJyb3IgPSAw
OworCisJc3dpdGNoIChpZCkgeworCWNhc2UgUkVBRElOR19NT0RVTEU6CisJCWxhYmVsID0gX19i
ZWdpbl9jdXJyZW50X2xhYmVsX2NyaXRfc2VjdGlvbigpOworCQllcnJvciA9IGFhX21vZHVsZV9m
cm9tX2ZpbGUobGFiZWwsIGNvbnRlbnRzID8gZmlsZSA6IE5VTEwsIEFBX01BWV9MT0FEX0ZJTEUp
OworCQlfX2VuZF9jdXJyZW50X2xhYmVsX2NyaXRfc2VjdGlvbihsYWJlbCk7CisJCWJyZWFrOwor
CWRlZmF1bHQ6CisJCWJyZWFrOworCX0KKworCXJldHVybiBlcnJvcjsKK30KKwogLyoKICAqIFRo
ZSBjcmVkIGJsb2IgaXMgYSBwb2ludGVyIHRvLCBub3QgYW4gaW5zdGFuY2Ugb2YsIGFuIGFhX3Rh
c2tfY3R4LgogICovCkBAIC0xMjY3LDYgKzEzMTksMTAgQEAgc3RhdGljIHN0cnVjdCBzZWN1cml0
eV9ob29rX2xpc3QgYXBwYXJtb3JfaG9va3NbXSBfX2xzbV9yb19hZnRlcl9pbml0ID0gewogCUxT
TV9IT09LX0lOSVQoc2VjaWRfdG9fc2VjY3R4LCBhcHBhcm1vcl9zZWNpZF90b19zZWNjdHgpLAog
CUxTTV9IT09LX0lOSVQoc2VjY3R4X3RvX3NlY2lkLCBhcHBhcm1vcl9zZWNjdHhfdG9fc2VjaWQp
LAogCUxTTV9IT09LX0lOSVQocmVsZWFzZV9zZWNjdHgsIGFwcGFybW9yX3JlbGVhc2Vfc2VjY3R4
KSwKKworCUxTTV9IT09LX0lOSVQoa2VybmVsX21vZHVsZV9yZXF1ZXN0LCBhcHBhcm1vcl9rZXJu
ZWxfbW9kdWxlX3JlcXVlc3QpLAorCUxTTV9IT09LX0lOSVQoa2VybmVsX2xvYWRfZGF0YSwgYXBw
YXJtb3Jfa2VybmVsX2xvYWRfZGF0YSksCisJTFNNX0hPT0tfSU5JVChrZXJuZWxfcmVhZF9maWxl
LCBhcHBhcm1vcl9rZXJuZWxfcmVhZF9maWxlKSwKIH07CiAKIC8qCmRpZmYgLS1naXQgYS9zZWN1
cml0eS9hcHBhcm1vci9tb2R1bGUuYyBiL3NlY3VyaXR5L2FwcGFybW9yL21vZHVsZS5jCm5ldyBm
aWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uNmY3MTRkYmY4M2I2Ci0tLSAvZGV2
L251bGwKKysrIGIvc2VjdXJpdHkvYXBwYXJtb3IvbW9kdWxlLmMKQEAgLTAsMCArMSwyNzUgQEAK
Ky8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkKKy8qCisgKiBBcHBBcm1v
ciBzZWN1cml0eSBtb2R1bGUKKyAqCisgKiBUaGlzIGZpbGUgY29udGFpbnMgQXBwQXJtb3IgbW9k
dWxlIG1lZGlhdGlvbgorICoKKyAqIENvcHlyaWdodCAyMDIxIENhbm9uaWNhbCBMdGQuCisgKi8K
KworI2luY2x1ZGUgPGxpbnV4L2dmcC5oPgorI2luY2x1ZGUgPGxpbnV4L3BhdGguaD4KKworI2lu
Y2x1ZGUgImluY2x1ZGUvYXVkaXQuaCIKKyNpbmNsdWRlICJpbmNsdWRlL21vZHVsZS5oIgorI2lu
Y2x1ZGUgImluY2x1ZGUvcGF0aC5oIgorI2luY2x1ZGUgImluY2x1ZGUvcG9saWN5LmgiCisKKy8q
KgorICogYXVkaXRfbW9kdWxlX21hc2sgLSBjb252ZXJ0IG1hc2sgdG8gcGVybWlzc2lvbiBzdHJp
bmcKKyAqIEBtYXNrOiBwZXJtaXNzaW9uIG1hc2sgdG8gY29udmVydAorICoKKyAqIFJldHVybnM6
IHBvaW50ZXIgdG8gc3RhdGljIHN0cmluZworICovCitzdGF0aWMgY29uc3QgY2hhciAqYXVkaXRf
bW9kdWxlX21hc2sodTMyIG1hc2spCit7CisJc3dpdGNoIChtYXNrKSB7CisJY2FzZSBBQV9NQVlf
TE9BRF9EQVRBOgorCQlyZXR1cm4gImxvYWRfZGF0YSI7CisJY2FzZSBBQV9NQVlfTE9BRF9GSUxF
OgorCQlyZXR1cm4gImxvYWRfZmlsZSI7CisJY2FzZSBBQV9NQVlfUkVRVUVTVDoKKwkJcmV0dXJu
ICJyZXF1ZXN0IjsKKwl9CisJcmV0dXJuICIiOworfQorCisvKiBjYWxsYmFjayB0byBhdWRpdCBt
b2R1bGUgZmllbGRzICovCitzdGF0aWMgdm9pZCBhdWRpdF9tb2R1bGVfY2Ioc3RydWN0IGF1ZGl0
X2J1ZmZlciAqYWIsIHZvaWQgKnZhKQoreworCXN0cnVjdCBjb21tb25fYXVkaXRfZGF0YSAqc2Eg
PSB2YTsKKworCWlmIChhYWQoc2EpLT5yZXF1ZXN0ICYgQUFfVkFMSURfTU9EVUxFX1BFUk1TKSB7
CisJCWF1ZGl0X2xvZ19mb3JtYXQoYWIsICIgcmVxdWVzdGVkX21hc2s9XCIlc1wiIiwKKwkJCQkg
YXVkaXRfbW9kdWxlX21hc2soYWFkKHNhKS0+cmVxdWVzdCkpOworCisJCWlmIChhYWQoc2EpLT5k
ZW5pZWQgJiBBQV9WQUxJRF9NT0RVTEVfUEVSTVMpIHsKKwkJCWF1ZGl0X2xvZ19mb3JtYXQoYWIs
ICIgZGVuaWVkX21hc2s9XCIlc1wiIiwKKwkJCQkJIGF1ZGl0X21vZHVsZV9tYXNrKGFhZChzYSkt
PmRlbmllZCkpOworCQl9CisJfQorfQorCisvKioKKyAqIGF1ZGl0X21vZHVsZSAtIGhhbmRsZSB0
aGUgYXVkaXRpbmcgb2YgbW9kdWxlIG9wZXJhdGlvbnMKKyAqIEBwcm9maWxlOiB0aGUgcHJvZmls
ZSBiZWluZyBlbmZvcmNlZCAgKE5PVCBOVUxMKQorICogQHBlcm1zOiB0aGUgcGVybWlzc2lvbnMg
Y29tcHV0ZWQgZm9yIHRoZSByZXF1ZXN0IChOT1QgTlVMTCkKKyAqIEByZXF1ZXN0OiBwZXJtaXNz
aW9ucyByZXF1ZXN0ZWQKKyAqIEBuYW1lOiBuYW1lIG9mIG9iamVjdCBiZWluZyBtZWRpYXRlZCAo
TUFZIEJFIE5VTEwpCisgKiBAaW5mbzogZXh0cmEgaW5mb3JtYXRpb24gbWVzc2FnZSAoTUFZIEJF
IE5VTEwpCisgKiBAZXJyb3I6IDAgaWYgb3BlcmF0aW9uIGFsbG93ZWQgZWxzZSBmYWlsdXJlIGVy
cm9yIGNvZGUKKyAqIEBkYXRhX3R5cGU6IGF1ZGl0IGRhdGEgdHlwZQorICoKKyAqIFJldHVybnM6
IDAgb3IgZXJyb3Igb24gZmFpbHVyZQorICovCitzdGF0aWMgaW50IGF1ZGl0X21vZHVsZShzdHJ1
Y3QgYWFfcHJvZmlsZSAqcHJvZmlsZSwgc3RydWN0IGFhX3Blcm1zICpwZXJtcywKKwkJCXUzMiBy
ZXF1ZXN0LCBjb25zdCBjaGFyICpuYW1lLCBjb25zdCBjaGFyICppbmZvLAorCQkJaW50IGVycm9y
LCBpbnQgZGF0YV90eXBlKQoreworCWludCB0eXBlID0gQVVESVRfQVBQQVJNT1JfQVVUTzsKKwlE
RUZJTkVfQVVESVRfREFUQShzYSwgZGF0YV90eXBlLCBPUF9NT0RVTEUpOworCisJaWYgKGxpa2Vs
eSghZXJyb3IpKSB7CisJCXUzMiBtYXNrID0gcGVybXMtPmF1ZGl0OworCisJCWlmICh1bmxpa2Vs
eShBVURJVF9NT0RFKHByb2ZpbGUpID09IEFVRElUX0FMTCkpCisJCQltYXNrID0gMHhmZmZmOwor
CisJCS8qIG1hc2sgb2ZmIHBlcm1zIHRoYXQgYXJlIG5vdCBiZWluZyBmb3JjZSBhdWRpdGVkICov
CisJCXJlcXVlc3QgJj0gbWFzazsKKworCQlpZiAobGlrZWx5KCFyZXF1ZXN0KSkKKwkJCXJldHVy
biAwOworCQl0eXBlID0gQVVESVRfQVBQQVJNT1JfQVVESVQ7CisJfSBlbHNlIHsKKwkJLyogb25s
eSByZXBvcnQgcGVybWlzc2lvbnMgdGhhdCB3ZXJlIGRlbmllZCAqLworCQlyZXF1ZXN0ID0gcmVx
dWVzdCAmIH5wZXJtcy0+YWxsb3c7CisKKwkJaWYgKHJlcXVlc3QgJiBwZXJtcy0+a2lsbCkKKwkJ
CXR5cGUgPSBBVURJVF9BUFBBUk1PUl9LSUxMOworCisJCS8qIHF1aWV0IGtub3duIHJlamVjdHMs
IGFzc3VtZXMgcXVpZXQgYW5kIGtpbGwgZG8gbm90IG92ZXJsYXAgKi8KKwkJaWYgKChyZXF1ZXN0
ICYgcGVybXMtPnF1aWV0KSAmJgorCQkgICAgQVVESVRfTU9ERShwcm9maWxlKSAhPSBBVURJVF9O
T1FVSUVUICYmCisJCSAgICBBVURJVF9NT0RFKHByb2ZpbGUpICE9IEFVRElUX0FMTCkKKwkJCXJl
cXVlc3QgJj0gfnBlcm1zLT5xdWlldDsKKworCQlpZiAoIXJlcXVlc3QpCisJCQlyZXR1cm4gZXJy
b3I7CisJfQorCisJYWFkKCZzYSktPnJlcXVlc3QgPSByZXF1ZXN0OworCWlmIChkYXRhX3R5cGUg
PT0gTFNNX0FVRElUX0RBVEFfS01PRCkgeworCQljaGFyIG1vZHVsZV9uYW1lW01PRFVMRV9OQU1F
X0xFTl07CisJCS8qIGNvcHkgdG8gcmVtb3ZlIGNvbnN0ICovCisJCXN0cm5jcHkobW9kdWxlX25h
bWUsIG5hbWUsIE1PRFVMRV9OQU1FX0xFTiAtIDEpOworCQlzYS51Lmttb2RfbmFtZSA9IG1vZHVs
ZV9uYW1lOworCX0gZWxzZQorCQlhYWQoJnNhKS0+bmFtZSA9IG5hbWU7CisJYWFkKCZzYSktPmlu
Zm8gPSBpbmZvOworCWFhZCgmc2EpLT5lcnJvciA9IGVycm9yOworCWFhZCgmc2EpLT5kZW5pZWQg
PSBhYWQoJnNhKS0+cmVxdWVzdCAmIH5wZXJtcy0+YWxsb3c7CisKKwlyZXR1cm4gYWFfYXVkaXQo
dHlwZSwgcHJvZmlsZSwgJnNhLCBhdWRpdF9tb2R1bGVfY2IpOworfQorCisKKy8qKgorICogY29t
cHV0ZV9tb2R1bGVfcGVybXMgLSBjb21wdXRlIG1vZHVsZSBwZXJtaXNzaW9uIGFzc29jaWF0ZWQg
d2l0aCBAc3RhdGUKKyAqIEBkZmE6IGRmYSB0byBtYXRjaCBhZ2FpbnN0IChOT1QgTlVMTCkKKyAq
IEBzdGF0ZTogc3RhdGUgbWF0Y2ggZmluaXNoZWQgaW4KKyAqCisgKiBSZXR1cm5zOiBtb2R1bGUg
cGVybWlzc2lvbnMKKyAqLworc3RhdGljIHN0cnVjdCBhYV9wZXJtcyBjb21wdXRlX21vZHVsZV9w
ZXJtcyhzdHJ1Y3QgYWFfZGZhICpkZmEsCisJCQkJCSAgICB1bnNpZ25lZCBpbnQgc3RhdGUpCit7
CisJc3RydWN0IGFhX3Blcm1zIHBlcm1zID0geworCQkuYWxsb3cgPSBkZmFfdXNlcl9hbGxvdyhk
ZmEsIHN0YXRlKSwKKwkJLmF1ZGl0ID0gZGZhX3VzZXJfYXVkaXQoZGZhLCBzdGF0ZSksCisJCS5x
dWlldCA9IGRmYV91c2VyX3F1aWV0KGRmYSwgc3RhdGUpLAorCQkueGluZGV4ID0gZGZhX3VzZXJf
eGluZGV4KGRmYSwgc3RhdGUpLAorCX07CisKKwlyZXR1cm4gcGVybXM7Cit9CisKKworLyoqCisg
KiBhdWRpdF9tb2R1bGUgLSBoYW5kbGUgdGhlIGF1ZGl0aW5nIG9mIG1vZHVsZSBvcGVyYXRpb25z
CisgKiBAcHJvZmlsZTogdGhlIHByb2ZpbGUgYmVpbmcgZW5mb3JjZWQgIChOT1QgTlVMTCkKKyAq
IEBwZXJtczogdGhlIHBlcm1pc3Npb25zIGNvbXB1dGVkIGZvciB0aGUgcmVxdWVzdCAoTk9UIE5V
TEwpCisgKiBAcmVxdWVzdDogcGVybWlzc2lvbnMgcmVxdWVzdGVkCisgKiBAbmFtZTogbmFtZSBv
ZiBvYmplY3QgYmVpbmcgbWVkaWF0ZWQgKE1BWSBCRSBOVUxMKQorICogQGluZm86IGV4dHJhIGlu
Zm9ybWF0aW9uIG1lc3NhZ2UgKE1BWSBCRSBOVUxMKQorICogQGVycm9yOiAwIGlmIG9wZXJhdGlv
biBhbGxvd2VkIGVsc2UgZmFpbHVyZSBlcnJvciBjb2RlCisgKiBAZGF0YV90eXBlOiBhdWRpdCBk
YXRhIHR5cGUKKyAqCisgKiBSZXR1cm5zOiAwIG9yIGVycm9yIG9uIGZhaWx1cmUKKyAqLworc3Rh
dGljIGludCBtb2R1bGVfcGVybShzdHJ1Y3QgYWFfcHJvZmlsZSAqcHJvZmlsZSwKKwkJICAgICAg
IGNvbnN0IGNoYXIgKm5hbWUsIHUzMiByZXF1ZXN0LAorCQkgICAgICAgaW50IGRhdGFfdHlwZSkK
K3sKKwlpbnQgZXJyb3IgPSAwOworCXN0cnVjdCBhYV9wZXJtcyBwZXJtcyA9IHsgfTsKKwl1bnNp
Z25lZCBpbnQgc3RhdGU7CisKKwlpZiAocHJvZmlsZV91bmNvbmZpbmVkKHByb2ZpbGUpKQorCQly
ZXR1cm4gMDsKKworCWlmICghUFJPRklMRV9NRURJQVRFUyhwcm9maWxlLCBBQV9DTEFTU19NT0RV
TEUpKQorCQlyZXR1cm4gMDsKKworCXN0YXRlID0gYWFfZGZhX21hdGNoKHByb2ZpbGUtPnBvbGlj
eS5kZmEsCisJCQkgICAgIHByb2ZpbGUtPnBvbGljeS5zdGFydFtBQV9DTEFTU19NT0RVTEVdLAor
CQkJICAgICBuYW1lKTsKKwlwZXJtcyA9IGNvbXB1dGVfbW9kdWxlX3Blcm1zKHByb2ZpbGUtPnBv
bGljeS5kZmEsIHN0YXRlKTsKKworCWlmIChyZXF1ZXN0ICYgfnBlcm1zLmFsbG93KQorCQllcnJv
ciA9IC1FQUNDRVM7CisKKwlyZXR1cm4gYXVkaXRfbW9kdWxlKHByb2ZpbGUsICZwZXJtcywgcmVx
dWVzdCwgbmFtZSwgTlVMTCwKKwkJCSAgICBlcnJvciwgZGF0YV90eXBlKTsKK30KKworc3RhdGlj
IGludCBwYXRoX21vZHVsZV9wZXJtKHN0cnVjdCBhYV9wcm9maWxlICpwcm9maWxlLAorCQkJICAg
IGNvbnN0IHN0cnVjdCBwYXRoICpwYXRoLAorCQkJICAgIGNoYXIgKmJ1ZmZlciwgdTMyIHJlcXVl
c3QpCit7CisJY29uc3QgY2hhciAqbmFtZTsKKwljb25zdCBjaGFyICppbmZvID0gTlVMTDsKKwlp
bnQgZXJyb3I7CisKKwlpZiAocHJvZmlsZV91bmNvbmZpbmVkKHByb2ZpbGUpKQorCQlyZXR1cm4g
MDsKKworCWVycm9yID0gYWFfcGF0aF9uYW1lKHBhdGgsIHByb2ZpbGUtPnBhdGhfZmxhZ3MsIGJ1
ZmZlciwgJm5hbWUsICZpbmZvLAorCQkJICAgICBsYWJlbHNfcHJvZmlsZSgmcHJvZmlsZS0+bGFi
ZWwpLT5kaXNjb25uZWN0ZWQpOworCisJaWYgKGVycm9yKSB7CisJCXJldHVybiBhdWRpdF9tb2R1
bGUocHJvZmlsZSwgJm51bGxwZXJtcywgcmVxdWVzdCwgbmFtZSwgaW5mbywKKwkJCQkgICAgZXJy
b3IsIExTTV9BVURJVF9EQVRBX05PTkUpOworCX0KKworCXJldHVybiBtb2R1bGVfcGVybShwcm9m
aWxlLCBuYW1lLCByZXF1ZXN0LAorCQkJICAgTFNNX0FVRElUX0RBVEFfTk9ORSk7Cit9CisKKy8q
KgorICogYWFfbW9kdWxlX2Zyb21fZmlsZSAtIGhhbmRsZSBtb2R1bGUgbG9hZGluZyB0aHJvdWdo
IGEgZmlsZQorICogQGxhYmVsOiBsYWJlbCBiZWluZyBlbmZvcmNlZCAgKE5PVCBOVUxMKQorICog
QGZpbGU6IGZpbGUgdG8gdmFsaWRhdGUgbG9hZGluZyBwZXJtaXNzaW9ucyBvbiAoTUFZIEJFIE5V
TEwpCisgKiBAcmVxdWVzdDogcGVybWlzc2lvbnMgcmVxdWVzdGVkCisgKgorICogUmV0dXJuczog
MCBvciBlcnJvciBvbiBmYWlsdXJlCisgKi8KK2ludCBhYV9tb2R1bGVfZnJvbV9maWxlKHN0cnVj
dCBhYV9sYWJlbCAqbGFiZWwsIHN0cnVjdCBmaWxlICpmaWxlLAorCQkJdTMyIHJlcXVlc3QpCit7
CisJaW50IGVycm9yID0gMDsKKwlzdHJ1Y3QgYWFfcHJvZmlsZSAqcHJvZmlsZTsKKwljaGFyICpi
dWZmZXI7CisKKwlpZiAodW5jb25maW5lZChsYWJlbCkpIHsKKwkJZ290byBkb25lOworCX0KKwor
CWlmICghZmlsZSkgeworCQllcnJvciA9IC1FUEVSTTsKKwkJZXJyb3IgPSBmbl9mb3JfZWFjaChs
YWJlbCwgcHJvZmlsZSwKKwkJCQkgICAgYXVkaXRfbW9kdWxlKHByb2ZpbGUsICZudWxscGVybXMs
CisJCQkJCQkgcmVxdWVzdCwgTlVMTCwgTlVMTCwKKwkJCQkJCSBlcnJvciwgTFNNX0FVRElUX0RB
VEFfTk9ORSkpOworCQlnb3RvIGRvbmU7CisJfQorCisJYnVmZmVyID0gYWFfZ2V0X2J1ZmZlcihm
YWxzZSk7CisJaWYgKCFidWZmZXIpCisJCXJldHVybiAtRU5PTUVNOworCisJZXJyb3IgPSBmbl9m
b3JfZWFjaChsYWJlbCwgcHJvZmlsZSwKKwkJCSAgICBwYXRoX21vZHVsZV9wZXJtKHByb2ZpbGUs
CisJCQkJCSAgICAgJmZpbGUtPmZfcGF0aCwKKwkJCQkJICAgICBidWZmZXIsIHJlcXVlc3QpKTsK
KwlhYV9wdXRfYnVmZmVyKGJ1ZmZlcik7Citkb25lOgorCXJldHVybiBlcnJvcjsKK30KKworCitz
dGF0aWMgaW50IG5hbWVfbW9kdWxlX3Blcm0oc3RydWN0IGFhX3Byb2ZpbGUgKnByb2ZpbGUsCisJ
CQkgICAgY2hhciAqbmFtZSwgdTMyIHJlcXVlc3QsIGludCBkYXRhX3R5cGUpCit7CisJaWYgKHBy
b2ZpbGVfdW5jb25maW5lZChwcm9maWxlKSkKKwkJcmV0dXJuIDA7CisKKwlyZXR1cm4gbW9kdWxl
X3Blcm0ocHJvZmlsZSwgbmFtZSwgcmVxdWVzdCwKKwkJCSAgIGRhdGFfdHlwZSk7Cit9CisKKy8q
KgorICogYWFfbW9kdWxlX2Zyb21fZmlsZSAtIGhhbmRsZSBtb2R1bGUgbG9hZGluZyB0aHJvdWdo
IGEgZmlsZQorICogQGxhYmVsOiBsYWJlbCBiZWluZyBlbmZvcmNlZCAgKE5PVCBOVUxMKQorICog
QG5hbWU6IG5hbWUgb2Ygb2JqZWN0IGJlaW5nIG1lZGlhdGVkCisgKiBAcmVxdWVzdDogcGVybWlz
c2lvbnMgcmVxdWVzdGVkCisgKiBAZGF0YV90eXBlOiBhdWRpdCBkYXRhIHR5cGUKKyAqCisgKiBS
ZXR1cm5zOiAwIG9yIGVycm9yIG9uIGZhaWx1cmUKKyAqLworaW50IGFhX21vZHVsZV9mcm9tX25h
bWUoc3RydWN0IGFhX2xhYmVsICpsYWJlbCwgY2hhciAqbmFtZSwKKwkJCXUzMiByZXF1ZXN0LCBp
bnQgZGF0YV90eXBlKQoreworCXN0cnVjdCBhYV9wcm9maWxlICpwcm9maWxlOworCWludCBlcnJv
ciA9IDA7CisKKwlpZiAodW5jb25maW5lZChsYWJlbCkpIHsKKwkJZ290byBkb25lOworCX0KKwor
CWVycm9yID0gZm5fZm9yX2VhY2gobGFiZWwsIHByb2ZpbGUsCisJCQkgICAgbmFtZV9tb2R1bGVf
cGVybShwcm9maWxlLCBuYW1lLAorCQkJCQkgICAgIHJlcXVlc3QsIGRhdGFfdHlwZSkpOworZG9u
ZToKKwlyZXR1cm4gZXJyb3I7Cit9Ci0tIAoyLjI1LjEKCgotLSAKQXBwQXJtb3IgbWFpbGluZyBs
aXN0CkFwcEFybW9yQGxpc3RzLnVidW50dS5jb20KTW9kaWZ5IHNldHRpbmdzIG9yIHVuc3Vic2Ny
aWJlIGF0OiBodHRwczovL2xpc3RzLnVidW50dS5jb20vbWFpbG1hbi9saXN0aW5mby9hcHBhcm1v
cgo=
