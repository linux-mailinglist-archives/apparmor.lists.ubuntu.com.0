Return-Path: <apparmor-bounces@lists.ubuntu.com>
X-Original-To: lists+apparmor@lfdr.de
Delivered-To: lists+apparmor@lfdr.de
Received: from huckleberry.canonical.com (huckleberry.canonical.com [91.189.94.19])
	by mail.lfdr.de (Postfix) with ESMTPS id 6FF2D400773
	for <lists+apparmor@lfdr.de>; Fri,  3 Sep 2021 23:32:17 +0200 (CEST)
Received: from localhost ([127.0.0.1] helo=huckleberry.canonical.com)
	by huckleberry.canonical.com with esmtp (Exim 4.86_2)
	(envelope-from <apparmor-bounces@lists.ubuntu.com>)
	id 1mMGn1-0001kO-T4; Fri, 03 Sep 2021 21:31:59 +0000
Received: from smtp-relay-internal-0.internal ([10.131.114.225]
 helo=smtp-relay-internal-0.canonical.com)
 by huckleberry.canonical.com with esmtps
 (TLS1.2:ECDHE_RSA_AES_128_GCM_SHA256:128) (Exim 4.86_2)
 (envelope-from <georgia.garcia@canonical.com>) id 1mMGmy-0001jk-Cg
 for apparmor@lists.ubuntu.com; Fri, 03 Sep 2021 21:31:56 +0000
Received: from mail-ed1-f69.google.com (mail-ed1-f69.google.com
 [209.85.208.69])
 (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)
 key-exchange X25519 server-signature RSA-PSS (2048 bits) server-digest SHA256)
 (No client certificate requested)
 by smtp-relay-internal-0.canonical.com (Postfix) with ESMTPS id 2F2DE4017F
 for <apparmor@lists.ubuntu.com>; Fri,  3 Sep 2021 21:31:56 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=canonical.com;
 s=20210705; t=1630704716;
 bh=bWYb29WK0KhKwLuP7c638cLknEAvz0+LU8PCUa/tmyE=;
 h=From:To:Cc:Subject:Date:Message-Id:MIME-Version;
 b=XbVQ/AAIPnh07WPZwx+X0LfXk1OzbwO/LxHYWjs5dsxyzCXCfRuPBdKgsRspawJ9H
 D6pHJYWOzj0rADyEoblyENhh7C6CzopviVqSLALC9fD1Q/AICD/sh0B9Z6oq7to2NM
 xV7jDDfqv9i0EgK1TrrDI7XPfNxQSAcx/M4UfdJLCv7uKsfzDzkC7rL5f/x8qKJYXu
 +oXv3pXZ2vttqJNLDI3K+ZH8zKjMnTr5vuzbGwAIn0bOVCoO8n55bsXTWhNbMY4z1m
 /SYCHDfCd2dzFwn+lsI14RTOeYGWfhBvMKIkn3Bka25hmlQ1V/R7foIWG0vqhAPl1L
 Z5smH+NMISibw==
Received: by mail-ed1-f69.google.com with SMTP id
 s25-20020a50d499000000b003c1a8573042so272406edi.11
 for <apparmor@lists.ubuntu.com>; Fri, 03 Sep 2021 14:31:56 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=bWYb29WK0KhKwLuP7c638cLknEAvz0+LU8PCUa/tmyE=;
 b=gv4wOlk5QQ5XOUgaSNBli7DjfDii06ZHYpbDL559S2yW7mnfPuMQ72xRT23wfrF16c
 qk15Bs+m+ldwFoSkEQ0ULgeEtFYIoQ59tTTqPnE51vaChoTb7zaawQ7LpxKoKQq3CP1f
 q5G5dq2zUgJGF72aAn0edahMzytku4x4zJbpr3eOJaC+1UbSLkMXwP1T767f+ZVP/2mY
 48jpImSpI3Ytv+5L8YnbadjlxPZp9y5bJstbcL8K6dTkKS2mID2iSFTNQX+1UAVOzM5X
 wHo4Toxquxq++oZqtgKTU8BBMsjXlU2K4sBndZh4zHCTi1CZJqGBebUD3/v6PelJiwVp
 5ZLQ==
X-Gm-Message-State: AOAM532erUXYWqR2gT23wBznTwJpWZRrE+hlQDNdZgoIqDMdIbXut3CE
 fcuIw/zTvrckamwg+/ekJD2Uc2eIW4mM4qKx+WxTvzLef2s4u094dBjbsWl9yD/ee/ToRBcFN5X
 tmc/TkBjaAVmhhUTCX9V9T0l6cyycjmp9K8uf1A==
X-Received: by 2002:a17:906:6011:: with SMTP id
 o17mr883166ejj.157.1630704715432; 
 Fri, 03 Sep 2021 14:31:55 -0700 (PDT)
X-Google-Smtp-Source: ABdhPJx24UXaY3Xb05sNdw1KhLe9GPvn9agCUs1RRf2KDWcuhi+/ZCuSYT/C19WzVDeQ0zirQD82VQ==
X-Received: by 2002:a17:906:6011:: with SMTP id
 o17mr883149ejj.157.1630704715195; 
 Fri, 03 Sep 2021 14:31:55 -0700 (PDT)
Received: from localhost ([2001:67c:1562:8007::aac:4557])
 by smtp.gmail.com with ESMTPSA id f10sm142170ejc.51.2021.09.03.14.31.53
 (version=TLS1_3 cipher=TLS_AES_128_GCM_SHA256 bits=128/128);
 Fri, 03 Sep 2021 14:31:54 -0700 (PDT)
From: Georgia Garcia <georgia.garcia@canonical.com>
To: apparmor@lists.ubuntu.com
Date: Fri,  3 Sep 2021 18:31:49 -0300
Message-Id: <20210903213149.92758-1-georgia.garcia@canonical.com>
X-Mailer: git-send-email 2.25.1
MIME-Version: 1.0
Subject: [apparmor] [PATCH v2] apparmor: enable raw text policy
X-BeenThere: apparmor@lists.ubuntu.com
X-Mailman-Version: 2.1.20
Precedence: list
List-Id: AppArmor discussion <apparmor.lists.ubuntu.com>
List-Unsubscribe: <https://lists.ubuntu.com/mailman/options/apparmor>,
 <mailto:apparmor-request@lists.ubuntu.com?subject=unsubscribe>
List-Archive: <https://lists.ubuntu.com/archives/apparmor>
List-Post: <mailto:apparmor@lists.ubuntu.com>
List-Help: <mailto:apparmor-request@lists.ubuntu.com?subject=help>
List-Subscribe: <https://lists.ubuntu.com/mailman/listinfo/apparmor>,
 <mailto:apparmor-request@lists.ubuntu.com?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: apparmor-bounces@lists.ubuntu.com
Sender: "AppArmor" <apparmor-bounces@lists.ubuntu.com>

Q3VycmVudGx5IHRoZXJlJ3Mgbm8gd2F5IHRvIGludHJvc3BlY3QgdGhlIGN1cnJlbnQgdGV4dCBw
b2xpY3kgZm9yIGEKZ2l2ZW4gcHJvZmlsZS4gVGhpcyBhZGRzIHRoZSBmdW5jdGlvbmFsaXR5IG9m
IGhhdmluZyB0aGUgcmF3CnRleHQgcHJvZmlsZSBpbiB0aGUgcmF3ZGF0YSBmcyB3aGVuIGVuYWJs
ZWQgYnkgYSBjb25maWcuCgpJdCByZXVzZXMgdGhlIHJhd19kYXRhIGRhdGEgc3RydWN0dXJlIGJ5
IHN0b3JpbmcgdGhlIG9mZnNldCB0byB0aGUKdGV4dCBwb2xpY3kgYW5kIGl0cyBzaXplLiBUaGF0
IG1lYW5zIHRoYXQgdGhlIHJhdyB0ZXh0IGlzIGNvbXByZXNzZWQKYW5kIG11c3QgYmUgZGVjb21w
cmVzc2VkIGZvciByZWFkaW5nLiBUaGUgaW5mcmFzdHJ1Y3R1cmUgdG8gZG8gc28Kd2FzIHJldXNl
ZCBmcm9tIHJhd19kYXRhLgoKU2lnbmVkLW9mZi1ieTogR2VvcmdpYSBHYXJjaWEgPGdlb3JnaWEu
Z2FyY2lhQGNhbm9uaWNhbC5jb20+Ci0tLQpDaGFuZ2VzIHNpbmNlIHYxOgoKVXNlIHVucGFja19i
bG9iIGluc3RlYWQgb2YgdW5wYWNrX3N0ciBiZWNhdXNlIHRoZSB0ZXh0IHN0cmluZwpjYW4gYmUg
YXQgbW9zdCA2NEtCIChhIDE2IGJpdCB2YWx1ZSkgd2hpY2ggd2lsbCBiZSBwcm9ibGVtYXRpYyBv
biBhCmxhcmdlIHBvbGljeS4gQmxvYiBpcyBtb3JlIGFjY3VyYXRlIHNpbmNlIGl0IGhhcyBhIDMy
IGJpdCBsaW1pdC4KCnYxOiBodHRwczovL2xpc3RzLnVidW50dS5jb20vYXJjaGl2ZXMvYXBwYXJt
b3IvMjAyMS1KdWx5LzAxMjMzNy5odG1sCi0tLQogc2VjdXJpdHkvYXBwYXJtb3IvS2NvbmZpZyAg
ICAgICAgICAgICAgICAgfCAgOCArKysrCiBzZWN1cml0eS9hcHBhcm1vci9hcHBhcm1vcmZzLmMg
ICAgICAgICAgICB8IDQ2ICsrKysrKysrKysrKysrKysrKysrKysrCiBzZWN1cml0eS9hcHBhcm1v
ci9pbmNsdWRlL2FwcGFybW9yLmggICAgICB8ICAxICsKIHNlY3VyaXR5L2FwcGFybW9yL2luY2x1
ZGUvYXBwYXJtb3Jmcy5oICAgIHwgIDEgKwogc2VjdXJpdHkvYXBwYXJtb3IvaW5jbHVkZS9wb2xp
Y3lfdW5wYWNrLmggfCAgMyArKwogc2VjdXJpdHkvYXBwYXJtb3IvbHNtLmMgICAgICAgICAgICAg
ICAgICAgfCAgNiArKysKIHNlY3VyaXR5L2FwcGFybW9yL3BvbGljeV91bnBhY2suYyAgICAgICAg
IHwgMjcgKysrKysrKysrKystLQogNyBmaWxlcyBjaGFuZ2VkLCA4OSBpbnNlcnRpb25zKCspLCAz
IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3NlY3VyaXR5L2FwcGFybW9yL0tjb25maWcgYi9z
ZWN1cml0eS9hcHBhcm1vci9LY29uZmlnCmluZGV4IDM0OGVkNmNmYTA4YS4uYjhkNjRmNTExNzQy
IDEwMDY0NAotLS0gYS9zZWN1cml0eS9hcHBhcm1vci9LY29uZmlnCisrKyBiL3NlY3VyaXR5L2Fw
cGFybW9yL0tjb25maWcKQEAgLTQwLDYgKzQwLDE0IEBAIGNvbmZpZyBTRUNVUklUWV9BUFBBUk1P
Ul9IQVNIX0RFRkFVTFQKIAkgdGhlc2UgY2FzZXMgcG9saWN5IGhhc2hpbmcgY2FuIGJlIGRpc2Fi
bGVkIGJ5IGRlZmF1bHQgYW5kCiAJIGVuYWJsZWQgb25seSBpZiBuZWVkZWQuCiAKK2NvbmZpZyBT
RUNVUklUWV9BUFBBUk1PUl9URVhUX1BST0ZJTEUKKyAgICAgICBib29sICJFbmFibGUgc3RvcmFn
ZSBhbmQgaW50cm9zcGVjdGlvbiBvZiByYXcgdGV4dCBwcm9maWxlIgorICAgICAgIGRlcGVuZHMg
b24gU0VDVVJJVFlfQVBQQVJNT1IKKyAgICAgICBkZWZhdWx0IG4KKyAgICAgICBoZWxwCisgICAg
ICAgICBUaGlzIG9wdGlvbiBzZWxlY3RzIHdoZXRoZXIgcmF3IHRleHQgcHJvZmlsZXMgY2FuIGJl
IGxvYWRlZAorCSBhbmQgaW50cm9zcGVjdGVkIHZpYSB0aGUgYXBwYXJtb3IgZmlsZXN5c3RlbS4K
KwogY29uZmlnIFNFQ1VSSVRZX0FQUEFSTU9SX0RFQlVHCiAJYm9vbCAiQnVpbGQgQXBwQXJtb3Ig
d2l0aCBkZWJ1ZyBjb2RlIgogCWRlcGVuZHMgb24gU0VDVVJJVFlfQVBQQVJNT1IKZGlmZiAtLWdp
dCBhL3NlY3VyaXR5L2FwcGFybW9yL2FwcGFybW9yZnMuYyBiL3NlY3VyaXR5L2FwcGFybW9yL2Fw
cGFybW9yZnMuYwppbmRleCAyZWUzYjNkMjlmMTAuLjQxZTk1MmQ0MWZmMSAxMDA2NDQKLS0tIGEv
c2VjdXJpdHkvYXBwYXJtb3IvYXBwYXJtb3Jmcy5jCisrKyBiL3NlY3VyaXR5L2FwcGFybW9yL2Fw
cGFybW9yZnMuYwpAQCAtMTMzNSw2ICsxMzM1LDE4IEBAIHN0YXRpYyBpbnQgZGVmbGF0ZV9kZWNv
bXByZXNzKGNoYXIgKnNyYywgc2l6ZV90IHNsZW4sIGNoYXIgKmRzdCwgc2l6ZV90IGRsZW4pCiAJ
cmV0dXJuIGVycm9yOwogfQogCitzdGF0aWMgc3NpemVfdCByYXd0ZXh0X3JlYWQoc3RydWN0IGZp
bGUgKmZpbGUsIGNoYXIgX191c2VyICpidWYsCisJCQkgICAgc2l6ZV90IHNpemUsIGxvZmZfdCAq
cHBvcykKK3sKKwlzdHJ1Y3QgcmF3ZGF0YV9mX2RhdGEgKnByaXZhdGUgPSBmaWxlLT5wcml2YXRl
X2RhdGE7CisJdW5zaWduZWQgbG9uZyB0ZXh0X29mZnNldCA9IHByaXZhdGUtPmxvYWRkYXRhLT5y
YXdfdGV4dF9vZmZzZXQ7CisJc2l6ZV90IHRleHRfc2l6ZSA9IHByaXZhdGUtPmxvYWRkYXRhLT5y
YXdfdGV4dF9zaXplOworCisJcmV0dXJuIHNpbXBsZV9yZWFkX2Zyb21fYnVmZmVyKGJ1Ziwgc2l6
ZSwgcHBvcywKKwkJCQkgICAgICAgUkFXREFUQV9GX0RBVEFfQlVGKHByaXZhdGUpICsKKwkJCQkg
ICAgICAgdGV4dF9vZmZzZXQsIHRleHRfc2l6ZSk7Cit9CisKIHN0YXRpYyBzc2l6ZV90IHJhd2Rh
dGFfcmVhZChzdHJ1Y3QgZmlsZSAqZmlsZSwgY2hhciBfX3VzZXIgKmJ1Ziwgc2l6ZV90IHNpemUs
CiAJCQkgICAgbG9mZl90ICpwcG9zKQogewpAQCAtMTM5OSw2ICsxNDExLDEzIEBAIHN0YXRpYyBj
b25zdCBzdHJ1Y3QgZmlsZV9vcGVyYXRpb25zIHJhd2RhdGFfZm9wcyA9IHsKIAkucmVsZWFzZSA9
IHJhd2RhdGFfcmVsZWFzZSwKIH07CiAKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZmlsZV9vcGVyYXRp
b25zIHJhd3RleHRfZm9wcyA9IHsKKwkub3BlbiA9IHJhd2RhdGFfb3BlbiwKKwkucmVhZCA9IHJh
d3RleHRfcmVhZCwKKwkubGxzZWVrID0gZ2VuZXJpY19maWxlX2xsc2VlaywKKwkucmVsZWFzZSA9
IHJhd2RhdGFfcmVsZWFzZSwKK307CisKIHN0YXRpYyB2b2lkIHJlbW92ZV9yYXdkYXRhX2RlbnRz
KHN0cnVjdCBhYV9sb2FkZGF0YSAqcmF3ZGF0YSkKIHsKIAlpbnQgaTsKQEAgLTE0NzUsNiArMTQ5
NCwxNCBAQCBpbnQgX19hYV9mc19jcmVhdGVfcmF3ZGF0YShzdHJ1Y3QgYWFfbnMgKm5zLCBzdHJ1
Y3QgYWFfbG9hZGRhdGEgKnJhd2RhdGEpCiAJCWdvdG8gZmFpbDsKIAlyYXdkYXRhLT5kZW50c1tB
QUZTX0xPQUREQVRBX0NPTVBSRVNTRURfU0laRV0gPSBkZW50OwogCisJaWYgKGFhX2dfcmF3X3Rl
eHQpIHsKKwkJZGVudCA9IGFhZnNfY3JlYXRlX2ZpbGUoInJhd190ZXh0IiwgU19JRlJFRyB8IDA0
NDQsIGRpciwKKwkJCQkJcmF3ZGF0YSwgJnJhd3RleHRfZm9wcyk7CisJCWlmIChJU19FUlIoZGVu
dCkpCisJCQlnb3RvIGZhaWw7CisJCXJhd2RhdGEtPmRlbnRzW0FBRlNfTE9BRERBVEFfVEVYVF0g
PSBkZW50OworCX0KKwogCWRlbnQgPSBhYWZzX2NyZWF0ZV9maWxlKCJyYXdfZGF0YSIsIFNfSUZS
RUcgfCAwNDQ0LAogCQkJCSAgICAgIGRpciwgcmF3ZGF0YSwgJnJhd2RhdGFfZm9wcyk7CiAJaWYg
KElTX0VSUihkZW50KSkKQEAgLTE2NDksNiArMTY3NiwxNCBAQCBzdGF0aWMgY29uc3QgY2hhciAq
cmF3ZGF0YV9nZXRfbGlua19kYXRhKHN0cnVjdCBkZW50cnkgKmRlbnRyeSwKIAlyZXR1cm4gcmF3
ZGF0YV9nZXRfbGlua19iYXNlKGRlbnRyeSwgaW5vZGUsIGRvbmUsICJyYXdfZGF0YSIpOwogfQog
CisKK3N0YXRpYyBjb25zdCBjaGFyICpyYXdkYXRhX2dldF9saW5rX3RleHQoc3RydWN0IGRlbnRy
eSAqZGVudHJ5LAorCQkJCQkgc3RydWN0IGlub2RlICppbm9kZSwKKwkJCQkJIHN0cnVjdCBkZWxh
eWVkX2NhbGwgKmRvbmUpCit7CisJcmV0dXJuIHJhd2RhdGFfZ2V0X2xpbmtfYmFzZShkZW50cnks
IGlub2RlLCBkb25lLCAicmF3X3RleHQiKTsKK30KKwogc3RhdGljIGNvbnN0IHN0cnVjdCBpbm9k
ZV9vcGVyYXRpb25zIHJhd2RhdGFfbGlua19zaGExX2lvcHMgPSB7CiAJLmdldF9saW5rCT0gcmF3
ZGF0YV9nZXRfbGlua19zaGExLAogfTsKQEAgLTE2NTksNiArMTY5NCw5IEBAIHN0YXRpYyBjb25z
dCBzdHJ1Y3QgaW5vZGVfb3BlcmF0aW9ucyByYXdkYXRhX2xpbmtfYWJpX2lvcHMgPSB7CiBzdGF0
aWMgY29uc3Qgc3RydWN0IGlub2RlX29wZXJhdGlvbnMgcmF3ZGF0YV9saW5rX2RhdGFfaW9wcyA9
IHsKIAkuZ2V0X2xpbmsJPSByYXdkYXRhX2dldF9saW5rX2RhdGEsCiB9Oworc3RhdGljIGNvbnN0
IHN0cnVjdCBpbm9kZV9vcGVyYXRpb25zIHJhd2RhdGFfbGlua190ZXh0X2lvcHMgPSB7CisJLmdl
dF9saW5rCT0gcmF3ZGF0YV9nZXRfbGlua190ZXh0LAorfTsKIAogCiAvKgpAQCAtMTc1NCw2ICsx
NzkyLDE0IEBAIGludCBfX2FhZnNfcHJvZmlsZV9ta2RpcihzdHJ1Y3QgYWFfcHJvZmlsZSAqcHJv
ZmlsZSwgc3RydWN0IGRlbnRyeSAqcGFyZW50KQogCQkJZ290byBmYWlsOwogCQlhYV9nZXRfcHJv
eHkocHJvZmlsZS0+bGFiZWwucHJveHkpOwogCQlwcm9maWxlLT5kZW50c1tBQUZTX1BST0ZfUkFX
X0RBVEFdID0gZGVudDsKKworCQlkZW50ID0gYWFmc19jcmVhdGUoInJhd190ZXh0IiwgU19JRkxO
SyB8IDA0NDQsIGRpciwKKwkJCQkgICBwcm9maWxlLT5sYWJlbC5wcm94eSwgTlVMTCwgTlVMTCwK
KwkJCQkgICAmcmF3ZGF0YV9saW5rX3RleHRfaW9wcyk7CisJCWlmIChJU19FUlIoZGVudCkpCisJ
CQlnb3RvIGZhaWw7CisJCWFhX2dldF9wcm94eShwcm9maWxlLT5sYWJlbC5wcm94eSk7CisJCXBy
b2ZpbGUtPmRlbnRzW0FBRlNfUFJPRl9SQVdfVEVYVF0gPSBkZW50OwogCX0KIAogCWxpc3RfZm9y
X2VhY2hfZW50cnkoY2hpbGQsICZwcm9maWxlLT5iYXNlLnByb2ZpbGVzLCBiYXNlLmxpc3QpIHsK
ZGlmZiAtLWdpdCBhL3NlY3VyaXR5L2FwcGFybW9yL2luY2x1ZGUvYXBwYXJtb3IuaCBiL3NlY3Vy
aXR5L2FwcGFybW9yL2luY2x1ZGUvYXBwYXJtb3IuaAppbmRleCAxZmJhYmRiNTY1YTguLjQxNGYx
Mjk4YmYzYyAxMDA2NDQKLS0tIGEvc2VjdXJpdHkvYXBwYXJtb3IvaW5jbHVkZS9hcHBhcm1vci5o
CisrKyBiL3NlY3VyaXR5L2FwcGFybW9yL2luY2x1ZGUvYXBwYXJtb3IuaApAQCAtNDEsNSArNDEs
NiBAQCBleHRlcm4gYm9vbCBhYV9nX2xvY2tfcG9saWN5OwogZXh0ZXJuIGJvb2wgYWFfZ19sb2dz
eXNjYWxsOwogZXh0ZXJuIGJvb2wgYWFfZ19wYXJhbm9pZF9sb2FkOwogZXh0ZXJuIHVuc2lnbmVk
IGludCBhYV9nX3BhdGhfbWF4OworZXh0ZXJuIGJvb2wgYWFfZ19yYXdfdGV4dDsKIAogI2VuZGlm
IC8qIF9fQVBQQVJNT1JfSCAqLwpkaWZmIC0tZ2l0IGEvc2VjdXJpdHkvYXBwYXJtb3IvaW5jbHVk
ZS9hcHBhcm1vcmZzLmggYi9zZWN1cml0eS9hcHBhcm1vci9pbmNsdWRlL2FwcGFybW9yZnMuaApp
bmRleCA2ZTE0ZjZjZWNkYjkuLjg2ODg5NDZjOTY5ZiAxMDA2NDQKLS0tIGEvc2VjdXJpdHkvYXBw
YXJtb3IvaW5jbHVkZS9hcHBhcm1vcmZzLmgKKysrIGIvc2VjdXJpdHkvYXBwYXJtb3IvaW5jbHVk
ZS9hcHBhcm1vcmZzLmgKQEAgLTg5LDYgKzg5LDcgQEAgZW51bSBhYWZzX3Byb2ZfdHlwZSB7CiAJ
QUFGU19QUk9GX1JBV19EQVRBLAogCUFBRlNfUFJPRl9SQVdfSEFTSCwKIAlBQUZTX1BST0ZfUkFX
X0FCSSwKKwlBQUZTX1BST0ZfUkFXX1RFWFQsCiAJQUFGU19QUk9GX1NJWkVPRiwKIH07CiAKZGlm
ZiAtLWdpdCBhL3NlY3VyaXR5L2FwcGFybW9yL2luY2x1ZGUvcG9saWN5X3VucGFjay5oIGIvc2Vj
dXJpdHkvYXBwYXJtb3IvaW5jbHVkZS9wb2xpY3lfdW5wYWNrLmgKaW5kZXggZTBlMWNhN2ViYzM4
Li45YTc5YWQ4ZDM0MzkgMTAwNjQ0Ci0tLSBhL3NlY3VyaXR5L2FwcGFybW9yL2luY2x1ZGUvcG9s
aWN5X3VucGFjay5oCisrKyBiL3NlY3VyaXR5L2FwcGFybW9yL2luY2x1ZGUvcG9saWN5X3VucGFj
ay5oCkBAIC00Miw2ICs0Miw3IEBAIGVudW0gewogCUFBRlNfTE9BRERBVEFfSEFTSCwKIAlBQUZT
X0xPQUREQVRBX0RBVEEsCiAJQUFGU19MT0FEREFUQV9DT01QUkVTU0VEX1NJWkUsCisJQUFGU19M
T0FEREFUQV9URVhULAogCUFBRlNfTE9BRERBVEFfRElSLAkJLyogbXVzdCBiZSBsYXN0IGFjdHVh
bCBlbnRyeSAqLwogCUFBRlNfTE9BRERBVEFfTkRFTlRTCQkvKiBjb3VudCBvZiBlbnRyaWVzICov
CiB9OwpAQCAtNjcsNiArNjgsOCBAQCBzdHJ1Y3QgYWFfbG9hZGRhdGEgewogCWxvbmcgcmV2aXNp
b247CQkJLyogdGhlIG5zIHBvbGljeSByZXZpc2lvbiB0aGlzIGNhdXNlZCAqLwogCWludCBhYmk7
CiAJdW5zaWduZWQgY2hhciAqaGFzaDsKKwl1bnNpZ25lZCBsb25nIHJhd190ZXh0X29mZnNldDsJ
LyogdGhlIG9mZnNldCBvZiBkYXRhIHRvIHRoZSByYXdfdGV4dCovCisJc2l6ZV90IHJhd190ZXh0
X3NpemU7CQkvKiB0aGUgc2l6ZSBvZiB0aGUgcmF3IHRleHQgcG9saWN5ICovCiAKIAkvKiBQb2lu
dGVyIHRvIHBheWxvYWQuIElmIEBjb21wcmVzc2VkX3NpemUgPiAwLCB0aGVuIHRoaXMgaXMgdGhl
CiAJICogY29tcHJlc3NlZCB2ZXJzaW9uIG9mIHRoZSBwYXlsb2FkLCBlbHNlIGl0IGlzIHRoZSB1
bmNvbXByZXNzZWQKZGlmZiAtLWdpdCBhL3NlY3VyaXR5L2FwcGFybW9yL2xzbS5jIGIvc2VjdXJp
dHkvYXBwYXJtb3IvbHNtLmMKaW5kZXggZjcyNDA2ZmUxYmYyLi5lM2I1YjJkZmFjNGEgMTAwNjQ0
Ci0tLSBhL3NlY3VyaXR5L2FwcGFybW9yL2xzbS5jCisrKyBiL3NlY3VyaXR5L2FwcGFybW9yL2xz
bS5jCkBAIC0xMzc1LDYgKzEzNzUsMTIgQEAgbW9kdWxlX3BhcmFtX25hbWVkKHBhdGhfbWF4LCBh
YV9nX3BhdGhfbWF4LCBhYXVpbnQsIFNfSVJVU1IpOwogYm9vbCBhYV9nX3BhcmFub2lkX2xvYWQg
PSB0cnVlOwogbW9kdWxlX3BhcmFtX25hbWVkKHBhcmFub2lkX2xvYWQsIGFhX2dfcGFyYW5vaWRf
bG9hZCwgYWFib29sLCBTX0lSVUdPKTsKIAorLyogRGV0ZXJtaW5lcyBpZiByYXcgdGV4dCBwb2xp
Y3kgaXMgYXZhaWxhYmxlICovCitib29sIGFhX2dfcmF3X3RleHQgPSBJU19FTkFCTEVEKENPTkZJ
R19TRUNVUklUWV9BUFBBUk1PUl9URVhUX1BST0ZJTEUpOworI2lmZGVmIENPTkZJR19TRUNVUklU
WV9BUFBBUk1PUl9URVhUX1BST0ZJTEUKK21vZHVsZV9wYXJhbV9uYW1lZChyYXdfdGV4dCwgYWFf
Z19yYXdfdGV4dCwgYWFib29sLCAwNjAwKTsKKyNlbmRpZgorCiBzdGF0aWMgaW50IHBhcmFtX2dl
dF9hYWludGJvb2woY2hhciAqYnVmZmVyLCBjb25zdCBzdHJ1Y3Qga2VybmVsX3BhcmFtICprcCk7
CiBzdGF0aWMgaW50IHBhcmFtX3NldF9hYWludGJvb2woY29uc3QgY2hhciAqdmFsLCBjb25zdCBz
dHJ1Y3Qga2VybmVsX3BhcmFtICprcCk7CiAjZGVmaW5lIHBhcmFtX2NoZWNrX2FhaW50Ym9vbCBw
YXJhbV9jaGVja19pbnQKZGlmZiAtLWdpdCBhL3NlY3VyaXR5L2FwcGFybW9yL3BvbGljeV91bnBh
Y2suYyBiL3NlY3VyaXR5L2FwcGFybW9yL3BvbGljeV91bnBhY2suYwppbmRleCA0ZTFmOTZiMjE2
YTguLjg2ZDQ2NTU4ZTFiNyAxMDA2NDQKLS0tIGEvc2VjdXJpdHkvYXBwYXJtb3IvcG9saWN5X3Vu
cGFjay5jCisrKyBiL3NlY3VyaXR5L2FwcGFybW9yL3BvbGljeV91bnBhY2suYwpAQCAtNjY4LDE3
ICs2NjgsMjMgQEAgc3RhdGljIGludCBkYXRhY21wKHN0cnVjdCByaGFzaHRhYmxlX2NvbXBhcmVf
YXJnICphcmcsIGNvbnN0IHZvaWQgKm9iaikKIC8qKgogICogdW5wYWNrX3Byb2ZpbGUgLSB1bnBh
Y2sgYSBzZXJpYWxpemVkIHByb2ZpbGUKICAqIEBlOiBzZXJpYWxpemVkIGRhdGEgZXh0ZW50IGlu
Zm9ybWF0aW9uIChOT1QgTlVMTCkKKyAqIEBuc19uYW1lOiAgcG9pbnRlciB0byB0aGUgc3RyaW5n
IGNvbnRhaW5pbmcgdGhlIG5zIG5hbWUKKyAqIEByYXdfdGV4dF9zaXplOiBwb2ludGVyIHRvIHRo
ZSBzaXplIG9mIHRoZSByYXcgdGV4dCBwcm9maWxlCisgKiBAcmF3X3RleHRfb2Zmc2V0OiBwb2lu
dGVyIHRvIHRoZSBvZmZzZXQgb2YgdGhlIHJhdyBwcm9maWxlIGluIGRhdGEKICAqCiAgKiBOT1RF
OiB1bnBhY2sgcHJvZmlsZSBzZXRzIGF1ZGl0IHN0cnVjdCBpZiB0aGVyZSBpcyBhIGZhaWx1cmUK
ICAqLwotc3RhdGljIHN0cnVjdCBhYV9wcm9maWxlICp1bnBhY2tfcHJvZmlsZShzdHJ1Y3QgYWFf
ZXh0ICplLCBjaGFyICoqbnNfbmFtZSkKK3N0YXRpYyBzdHJ1Y3QgYWFfcHJvZmlsZSAqdW5wYWNr
X3Byb2ZpbGUoc3RydWN0IGFhX2V4dCAqZSwKKwkJCQkJIGNoYXIgKipuc19uYW1lLAorCQkJCQkg
c2l6ZV90ICpyYXdfdGV4dF9zaXplLAorCQkJCQkgdW5zaWduZWQgbG9uZyAqcmF3X3RleHRfb2Zm
c2V0KQogewogCXN0cnVjdCBhYV9wcm9maWxlICpwcm9maWxlID0gTlVMTDsKIAljb25zdCBjaGFy
ICp0bXBuYW1lLCAqdG1wbnMgPSBOVUxMLCAqbmFtZSA9IE5VTEw7CiAJY29uc3QgY2hhciAqaW5m
byA9ICJmYWlsZWQgdG8gdW5wYWNrIHByb2ZpbGUiOwogCXNpemVfdCBuc19sZW47CiAJc3RydWN0
IHJoYXNodGFibGVfcGFyYW1zIHBhcmFtcyA9IHsgMCB9OwotCWNoYXIgKmtleSA9IE5VTEw7CisJ
Y2hhciAqa2V5ID0gTlVMTCwgKnRtcHRleHQ7CiAJc3RydWN0IGFhX2RhdGEgKmRhdGE7CiAJaW50
IGksIGVycm9yID0gLUVQUk9UTzsKIAlrZXJuZWxfY2FwX3QgdG1wY2FwOwpAQCAtOTE3LDYgKzky
MywxMiBAQCBzdGF0aWMgc3RydWN0IGFhX3Byb2ZpbGUgKnVucGFja19wcm9maWxlKHN0cnVjdCBh
YV9leHQgKmUsIGNoYXIgKipuc19uYW1lKQogCQl9CiAJfQogCisJLyogdGV4dCBwb2xpY3kgaXMg
b3B0aW5hbCAqLworCSpyYXdfdGV4dF9zaXplID0gdW5wYWNrX2Jsb2IoZSwgJnRtcHRleHQsICJ0
ZXh0X3BvbGljeSIpOworCWlmICgqcmF3X3RleHRfc2l6ZSkgeworCQkqcmF3X3RleHRfb2Zmc2V0
ID0gKHZvaWQgKikgdG1wdGV4dCAtIGUtPnN0YXJ0OworCX0KKwogCWlmICghdW5wYWNrX25hbWVY
KGUsIEFBX1NUUlVDVEVORCwgTlVMTCkpIHsKIAkJaW5mbyA9ICJmYWlsZWQgdG8gdW5wYWNrIGVu
ZCBvZiBwcm9maWxlIjsKIAkJZ290byBmYWlsOwpAQCAtMTE3NSwxOCArMTE4NywyNyBAQCBpbnQg
YWFfdW5wYWNrKHN0cnVjdCBhYV9sb2FkZGF0YSAqdWRhdGEsIHN0cnVjdCBsaXN0X2hlYWQgKmxo
LAogCSpucyA9IE5VTEw7CiAJd2hpbGUgKGUucG9zIDwgZS5lbmQpIHsKIAkJY2hhciAqbnNfbmFt
ZSA9IE5VTEw7CisJCXNpemVfdCByYXdfdGV4dF9zaXplID0gMDsKKwkJdW5zaWduZWQgbG9uZyBy
YXdfdGV4dF9vZmZzZXQ7CiAJCXZvaWQgKnN0YXJ0OwogCQllcnJvciA9IHZlcmlmeV9oZWFkZXIo
JmUsIGUucG9zID09IGUuc3RhcnQsIG5zKTsKIAkJaWYgKGVycm9yKQogCQkJZ290byBmYWlsOwog
CiAJCXN0YXJ0ID0gZS5wb3M7Ci0JCXByb2ZpbGUgPSB1bnBhY2tfcHJvZmlsZSgmZSwgJm5zX25h
bWUpOworCQlwcm9maWxlID0gdW5wYWNrX3Byb2ZpbGUoJmUsICZuc19uYW1lLAorCQkJCQkgJnJh
d190ZXh0X3NpemUsCisJCQkJCSAmcmF3X3RleHRfb2Zmc2V0KTsKIAkJaWYgKElTX0VSUihwcm9m
aWxlKSkgewogCQkJZXJyb3IgPSBQVFJfRVJSKHByb2ZpbGUpOwogCQkJZ290byBmYWlsOwogCQl9
CiAKKwkJaWYgKGFhX2dfcmF3X3RleHQgJiYgcmF3X3RleHRfc2l6ZSkgeworCQkJdWRhdGEtPnJh
d190ZXh0X3NpemUgPSByYXdfdGV4dF9zaXplOworCQkJdWRhdGEtPnJhd190ZXh0X29mZnNldCA9
IHJhd190ZXh0X29mZnNldDsKKwkJfQorCiAJCWVycm9yID0gdmVyaWZ5X3Byb2ZpbGUocHJvZmls
ZSk7CiAJCWlmIChlcnJvcikKIAkJCWdvdG8gZmFpbF9wcm9maWxlOwotLSAKMi4yNS4xCgoKLS0g
CkFwcEFybW9yIG1haWxpbmcgbGlzdApBcHBBcm1vckBsaXN0cy51YnVudHUuY29tCk1vZGlmeSBz
ZXR0aW5ncyBvciB1bnN1YnNjcmliZSBhdDogaHR0cHM6Ly9saXN0cy51YnVudHUuY29tL21haWxt
YW4vbGlzdGluZm8vYXBwYXJtb3IK
